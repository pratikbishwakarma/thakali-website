<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thakali Kitchen - Authentic Nepali Cuisine in Kathmandu</title>
    <meta name="description" content="Experience the flavors of Nepal at Thakali Kitchen. Fresh, traditional dishes in the heart of Kathmandu. Book now for an unforgettable meal!">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Roboto', sans-serif; 
            margin: 0; 
            padding: 0; 
            line-height: 1.6; 
            color: #333; 
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); 
        }
        header { 
            background: linear-gradient(135deg, #ff6b35, #f7931e); 
            color: white; 
            padding: 40px 20px; 
            text-align: center; 
            box-shadow: 0 4px 8px rgba(0,0,0,0.2); 
            position: relative; 
        }
        header::after { 
            content: ''; 
            position: absolute; 
            bottom: 0; 
            left: 50%; 
            transform: translateX(-50%); 
            width: 100px; 
            height: 4px; 
            background: white; 
        }
        nav { 
            background: #2c3e50; 
            padding: 15px; 
            text-align: center; 
            position: sticky; 
            top: 0; 
            z-index: 100; 
        }
        nav a { 
            color: white; 
            margin: 0 20px; 
            text-decoration: none; 
            font-weight: 700; 
            transition: color 0.3s; 
        }
        nav a:hover { color: #ff6b35; }
        section { 
            padding: 40px 20px; 
            max-width: 1200px; 
            margin: auto; 
        }
        .hero { 
            background: url('https://images.unsplash.com/photo-1555396273-367ea4eb4db5?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80') no-repeat center/cover; 
            height: 500px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: white; 
            text-shadow: 2px 2px 8px rgba(0,0,0,0.8); 
            position: relative; 
        }
        .hero::before { 
            content: ''; 
            position: absolute; 
            top: 0; 
            left: 0; 
            right: 0; 
            bottom: 0; 
            background: rgba(0,0,0,0.4); 
        }
        .hero > div { position: relative; z-index: 1; }
        .hero h1 { font-size: 3.5em; margin-bottom: 10px; }
        .hero p { font-size: 1.2em; max-width: 600px; margin: auto; }
        .gallery { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 20px; 
            margin-top: 20px; 
        }
        .gallery img { 
            width: 100%; 
            height: 250px; 
            object-fit: cover; 
            border-radius: 12px; 
            transition: transform 0.3s, box-shadow 0.3s; 
            cursor: pointer; 
        }
        .gallery img:hover { 
            transform: scale(1.05); 
            box-shadow: 0 8px 16px rgba(0,0,0,0.3); 
        }
        .reviews { 
            background: white; 
            padding: 30px; 
            border-radius: 12px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.1); 
            margin-top: 20px; 
        }
        .review { 
            margin-bottom: 20px; 
            border-bottom: 1px solid #eee; 
            padding-bottom: 15px; 
            display: flex; 
            align-items: flex-start; 
        }
        .review img { 
            width: 50px; 
            height: 50px; 
            border-radius: 50%; 
            margin-right: 15px; 
        }
        .review strong { color: #ff6b35; }
        .rating { color: #f7931e; font-weight: bold; }
        .chef-story { 
            background: #fff3cd; 
            padding: 30px; 
            border-radius: 12px; 
            text-align: center; 
            margin: 40px 0; 
        }
        form { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 20px; 
            max-width: 600px; 
            margin: 20px auto; 
        }
        form input, form textarea { 
            padding: 12px; 
            border: 1px solid #ccc; 
            border-radius: 8px; 
            font-size: 1em; 
        }
        form textarea { grid-column: span 2; }
        button { 
            background: linear-gradient(135deg, #ff6b35, #f7931e); 
            color: white; 
            padding: 12px 20px; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 1em; 
            transition: background 0.3s; 
            grid-column: span 2; 
        }
        button:hover { background: linear-gradient(135deg, #f7931e, #ff6b35); }
        footer { 
            background: #2c3e50; 
            color: white; 
            text-align: center; 
            padding: 20px; 
            margin-top: 40px; 
        }
        @media (max-width: 768px) { 
            .hero h1 { font-size: 2.5em; }
            form { grid-template-columns: 1fr; }
            form textarea { grid-column: span 1; }
            button { grid-column: span 1; }
            .gallery { grid-template-columns: 1fr; }
        }
        .carousel { 
            position: relative; 
            overflow: hidden; 
            border-radius: 12px; 
        }
        .carousel img { 
            width: 100%; 
            height: 300px; 
            object-fit: cover; 
            display: none; 
        }
        .carousel img.active { display: block; }
        .carousel button { 
            position: absolute; 
            top: 50%; 
            transform: translateY(-50%); 
            background: rgba(0,0,0,0.5); 
            color: white; 
            border: none; 
            padding: 10px; 
            cursor: pointer; 
            font-size: 1.5em; 
        }
        .carousel .prev { left: 10px; }
        .carousel .next { right: 10px; }

        /* Menu and cart styles */
        .category-btn { 
            padding: 10px 14px; 
            border-radius: 8px; 
            border: 1px solid rgba(0,0,0,0.06); 
            background: white; 
            cursor: pointer; 
            font-weight: 700; 
        }
        .category-btn.active { box-shadow: 0 6px 18px rgba(0,0,0,0.06); transform: translateY(-3px); }
        .category-btn:hover { background:#f8f8f8; }
        .menu-grid { 
            display:grid; 
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); 
            gap:20px; 
            margin-top:20px; 
        }
        .menu-card { 
            background: white; 
            padding:12px; 
            border-radius:12px; 
            box-shadow: 0 6px 18px rgba(0,0,0,0.06); 
            display:flex; 
            gap:12px; 
            align-items:flex-start; 
            flex-direction:column;
            transition: transform 0.18s, box-shadow 0.18s; 
            text-align:left;
        }
        .menu-card:hover { transform: translateY(-6px); box-shadow: 0 14px 30px rgba(0,0,0,0.12); }
        .menu-card img { 
            width:100%; 
            height:160px; 
            object-fit:cover; 
            border-radius:10px; 
            background: linear-gradient(135deg,#ff6b35,#f7931e);
            display:block;
        }
        .menu-info { width:100%; }
        .menu-title { font-weight:700; color:#ff6b35; font-size:1.05em; margin-top:8px; }
        .menu-desc { font-size:0.95em; color:#666; margin-top:6px; }
        .menu-price { font-weight:700; margin-top:8px; }
        .menu-cat { color:#111; font-size:0.85em; font-weight:700; background:#fff; padding:4px 8px; border-radius:6px; display:inline-block; margin-top:6px; }
        .add-btn { 
            background:#ff6b35; 
            color:white; 
            border:none; 
            padding:8px 10px; 
            border-radius:8px; 
            cursor:pointer; 
        }
        @media (max-width:480px) {
            .menu-card img { height:140px; }
            .menu-title { font-size:1em; }
            .menu-desc { font-size:0.92em; }
        }
        .add-btn:hover { filter:brightness(0.95); }
        .cart-btn { 
            background: transparent; 
            color: white; 
            border: 1px solid rgba(255,255,255,0.2); 
            padding:8px 12px; 
            border-radius:8px; 
            cursor:pointer; 
            display:inline-flex; 
            align-items:center; 
            gap:8px; 
        }
        .badge { 
            background: #f7931e; 
            color: white; 
            padding:2px 8px; 
            border-radius:12px; 
            font-weight:700; 
            margin-left:4px; 
            font-size:0.85em; 
        }
        .cart-panel { 
            position: fixed; 
            right: 20px; 
            bottom: 20px; 
            width: 320px; 
            background: white; 
            border-radius:12px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.2); 
            padding:16px; 
            display:none; 
            z-index:999; 
        }
        .cart-panel[aria-hidden="false"] { display:block; }
        .cart-item { display:flex; justify-content:space-between; padding:8px 0; border-bottom:1px solid #eee; }
        .cart-summary { margin-top:12px; font-size:1.05em; }
        .close-cart { position:absolute; top:8px; right:10px; background:transparent; border:none; cursor:pointer; font-size:1.1em; }
        .success { background:#dff0d8; color:#2b6a2b; padding:10px; border-radius:8px; margin:10px 0; }

        /* Order confirmation modal */
        .order-modal { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(0,0,0,0.45); z-index: 10000; }
        .order-modal.show { display: flex; }
        .order-modal-content { background: white; border-radius: 12px; padding: 20px; width: 95%; max-width: 420px; box-shadow: 0 20px 40px rgba(0,0,0,0.25); position: relative; }
        .order-modal h3 { margin-top: 0; color: #ff6b35; }
        .order-modal .order-details { margin-top: 10px; max-height: 240px; overflow:auto; }
        .order-modal .order-item { display:flex; justify-content:space-between; padding:6px 0; border-bottom:1px solid #f0f0f0; }
        .order-modal .order-total { font-weight:700; margin-top:10px; text-align:right; }
        .order-modal .order-actions { display:flex; gap:10px; justify-content:flex-end; margin-top:12px; }
        .order-modal .btn { padding:8px 12px; border-radius:8px; border:none; cursor:pointer; }
        .order-modal .btn.secondary { background:#eee; color:#333; }
        .order-modal .btn.primary { background:#ff6b35; color:#fff; }
    </style>
</head>
<body>
    <header>
        <h1>Thakali Kitchen</h1>
        <p>Authentic Nepali Flavors in the Heart of Kathmandu</p>
    </header>
    <nav>
        <div style="max-width:1200px;margin:auto;display:flex;align-items:center;justify-content:center;gap:20px;flex-wrap:wrap;">
            <a href="#about">About</a>
            <a href="#menu">Menu</a>
            <a href="#reviews">Reviews</a>
            <a href="#contact">Contact</a>
            <button id="cart-btn" class="cart-btn" title="View cart">ðŸ§º Cart <span id="cart-count" class="badge">0</span></button>
        </div>
    </nav>
    
    <section class="hero" id="about">
        <div>
            <h1>Welcome to Thakali Kitchen</h1>
            <p>Dive into the rich traditions of Nepali cuisine, where every dish tells a story of the Himalayas. From momos to dal bhat, we've been serving up warmth and flavor since our humble beginnings. Updated with fresh ingredients and a cozy vibe, come join us for a meal that feels like home.</p>
        </div>
    </section>
    
    <section id="menu">
        <h2>Our Signature Menu</h2>
        <p>Handpicked from the best of Nepali kitchens â€” explore categories, add items to your cart, and place a simple simulated order.</p>

        <div style="max-width:1200px;margin:20px auto;display:flex;gap:12px;flex-wrap:wrap;justify-content:center;">
            <button class="category-btn" data-cat="All">All</button>
            <button class="category-btn" data-cat="Appetizer">Appetizers</button>
            <button class="category-btn" data-cat="Main">Mains</button>
            <button class="category-btn" data-cat="Drink">Drinks</button>
        </div>

        <div id="menu-grid" class="menu-grid">
            <!-- Menu items rendered via JS -->
        </div>

        <div id="cart-panel" class="cart-panel" aria-hidden="true">
            <h3>Your Cart</h3>
            <div id="cart-items"></div>
            <div class="cart-summary">
                <strong>Total:</strong> NPR <span id="cart-total">0.00</span>
            </div>
            <div style="display:flex;gap:10px;margin-top:10px;">
                <button id="checkout-btn">Checkout</button>
                <button id="clear-cart-btn" style="background:#ccc;color:#333;">Clear</button>
            </div>
            <button id="close-cart" class="close-cart" title="Close">âœ–</button>
        </div>

        <p>Pro tip: Try the Thakali set â€” a complete and satisfying taste of the region.</p>

        <div class="carousel" style="margin-top:20px;">
            <img src="https://images.unsplash.com/photo-1565299624946-b28f40a0ca4b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80" alt="Steamy Momos" class="active">
            <img src="https://images.unsplash.com/photo-1586190848861-99aa4a171e90?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80" alt="Dal Bhat Set">
            <img src="https://images.unsplash.com/photo-1551782450-17144efb5723?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80" alt="Thukpa Noodles">
            <button class="prev">&lt;</button>
            <button class="next">&gt;</button>
        </div>

        <!-- Order confirmation modal -->
        <div id="order-modal" class="order-modal" aria-hidden="true">
            <div class="order-modal-content" role="dialog" aria-modal="true" aria-labelledby="order-title">
                <button class="order-modal-close" aria-label="Close" style="position:absolute;right:12px;top:10px;background:transparent;border:none;font-size:18px;cursor:pointer;">âœ–</button>
                <h3 id="order-title">Order Confirmed!</h3>
                <p id="order-msg">Thank you â€” your order has been received (simulated).</p>
                <div class="order-details" id="order-details"></div>
                <div class="order-total" id="order-total"></div>
                <div class="order-actions">
                    <button id="print-order" class="btn secondary">Print</button>
                    <button id="close-order" class="btn primary">Close</button>
                </div>
            </div>
        </div>
    </section>
    
    <section class="chef-story">
        <h2>Meet Our Chef</h2>
        <p>Chef Ram Prasad, a native of the Thakali region, brings over 20 years of experience crafting dishes that honor Nepal's culinary heritage. His passion for fresh, sustainable ingredients shines through in every bite.</p>
    </section>
    
    <section id="reviews" class="reviews">
        <h2>What Our Guests Say</h2>
        <p>Based on real reviews from TripAdvisor and beyond, here's what folks are raving about:</p>
        <div class="review">
            <img src="https://via.placeholder.com/50" alt="John D.">
            <div>
                <strong>John D. from Australia:</strong> "Absolutely loved the momos! Fresh, flavorful, and the service was top-notch. Felt like I was in a real Nepali home." <span class="rating">5/5 â˜…â˜…â˜…â˜…â˜…</span>
            </div>
        </div>
        <div class="review">
            <img src="https://via.placeholder.com/50" alt="Sarah L.">
            <div>
                <strong>Sarah L. from the US:</strong> "The dal bhat was comforting and authentic. Great spot for vegetarians. A bit crowded, but worth it." <span class="rating">4.5/5 â˜…â˜…â˜…â˜…â˜†</span>
            </div>
        </div>
        <div class="review">
            <img src="https://via.placeholder.com/50" alt="Rajesh P.">
            <div>
                <strong>Rajesh P. from Kathmandu:</strong> "Best Thakali food in town. The spices are spot-on, and the staff knows their stuff. Highly recommend the thukpa on a chilly day." <span class="rating">5/5 â˜…â˜…â˜…â˜…â˜…</span>
            </div>
        </div>
        <p>Overall Rating: 4.5/5 (from 500+ reviews). Come see why we're a local favorite!</p>
    </section>
    
    <section id="contact">
        <h2>Book a Table or Get in Touch</h2>
        <p>Ready for an adventure in flavors? Reserve your spot or drop us a line. We're at Thamel, Kathmanduâ€”easy to find!</p>
        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3532.123456789012!2d85.31234567890123!3d27.712345678901234!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x39eb190a2b1b1b1b%3A0x123456789abcdef!2sThakali%20Kitchen!5e0!3m2!1sen!2snp!4v1234567890123!5m2!1sen!2snp" width="100%" height="300" style="border:0; border-radius: 12px;" allowfullscreen="" loading="lazy"></iframe>

        <form id="contact-form">
            <input type="text" id="c-name" placeholder="Your Name" required>
            <input type="email" id="c-email" placeholder="Your Email" required>
            <input type="tel" id="c-phone" placeholder="Phone (optional)">
            <input type="date" id="c-date" placeholder="Reservation Date">
            <input type="time" id="c-time" placeholder="Reservation Time">
            <textarea id="c-message" placeholder="Message or Reservation Request" rows="4" required></textarea>
            <button type="submit">Send Message / Book</button>
        </form>

        <div style="max-width:800px;margin:20px auto;">
            <h3>Recent Requests</h3>
            <div id="messages-list" class="reviews"></div>
        </div>

        <p>Phone: +977-1-1234567 | Email: info@thakalikitchen.com</p>
    </section>
    
    <footer>
        <p>&copy; 2026 Thakali Kitchen. All rights reserved. Made with love in Kathmandu.</p>
    </footer>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Carousel
            let currentIndex = 0;
            const images = document.querySelectorAll('.carousel img');
            const prevBtn = document.querySelectorAll('.prev');
            const nextBtn = document.querySelectorAll('.next');

            function showImage(index, carouselIndex = 0) {
                const imgs = carouselIndex === 0 ? images : document.querySelectorAll('.carousel')[carouselIndex].querySelectorAll('img');
                imgs.forEach(img => img.classList.remove('active'));
                imgs[index].classList.add('active');
            }

            // Attach carousel controls for each carousel
            document.querySelectorAll('.carousel').forEach((carousel, cIndex) => {
                const imgs = carousel.querySelectorAll('img');
                let idx = 0;
                const p = carousel.querySelector('.prev');
                const n = carousel.querySelector('.next');
                if (!p || !n) return;

                p.addEventListener('click', () => {
                    idx = (idx - 1 + imgs.length) % imgs.length;
                    imgs.forEach(i => i.classList.remove('active'));
                    imgs[idx].classList.add('active');
                });
                n.addEventListener('click', () => {
                    idx = (idx + 1) % imgs.length;
                    imgs.forEach(i => i.classList.remove('active'));
                    imgs[idx].classList.add('active');
                });

                // Auto-slide per carousel
                setInterval(() => {
                    idx = (idx + 1) % imgs.length;
                    imgs.forEach(i => i.classList.remove('active'));
                    imgs[idx].classList.add('active');
                }, 5000 + (cIndex * 1000));
            });

            /* ---------- Menu Data & Rendering ---------- */
            const menuData = [
                { id: 'm1', name: 'Steamed Momos', desc: 'Juicy pork and vegetable dumplings served with spicy achar.', price: 250, category: 'Appetizer', img: 'https://images.unsplash.com/photo-1544025162-d76694265947?auto=format&fit=crop&w=400&q=60' },
                { id: 'm2', name: 'Thakali Set', desc: 'Traditional Thakali platter: rice, lentils, curry, pickles, and salad.', price: 650, category: 'Main', img: 'https://images.unsplash.com/photo-1604908177161-1b3d4f3b8c8f?auto=format&fit=crop&w=400&q=60' },
                { id: 'm3', name: 'Thukpa', desc: 'Hearty noodle soup with vegetables and choice of meat.', price: 300, category: 'Main', img: 'https://images.unsplash.com/photo-1553615127-8b5d305a3a36?auto=format&fit=crop&w=400&q=60' },
                { id: 'm4', name: 'Aloo Tama', desc: 'Classic potato and bamboo shoot curry.', price: 280, category: 'Main', img: 'https://images.unsplash.com/photo-1600180758894-2b1a7d6b4256?auto=format&fit=crop&w=400&q=60' },
                { id: 'm5', name: 'Ginger Tea', desc: 'House-made ginger tea, perfect with any meal.', price: 80, category: 'Drink', img: 'https://images.unsplash.com/photo-1517686469429-8b43d3720c7a?auto=format&fit=crop&w=400&q=60' },
                { id: 'm6', name: 'Masala Chai', desc: 'Spiced milk tea brewed to warm the soul.', price: 90, category: 'Drink', img: 'https://images.unsplash.com/photo-1516685018646-5497f1a5fde6?auto=format&fit=crop&w=400&q=60' },
                { id: 'm7', name: 'Paneer Momos', desc: 'Cottage cheese momos with mild spices.', price: 260, category: 'Appetizer', img: 'https://images.unsplash.com/photo-1598866598027-8b3a4568f8a1?auto=format&fit=crop&w=400&q=60' },
                { id: 'm8', name: 'Sel Roti', desc: 'Traditional Nepali sweet rice doughnut â€” crispy and delightful.', price: 120, category: 'Appetizer', img: 'https://images.unsplash.com/photo-1606756799294-9a6f5fb2b3b7?auto=format&fit=crop&w=400&q=60' }
            ];

            const menuGrid = document.getElementById('menu-grid');
            const categoryBtns = document.querySelectorAll('.category-btn');

            function generatePlaceholder(text) {
                const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='400' height='300'><defs><linearGradient id='g' x1='0' x2='1'><stop offset='0' stop-color='#ff6b35'/><stop offset='1' stop-color='#f7931e'/></linearGradient></defs><rect width='100%' height='100%' fill='url(#g)'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-family='Roboto, Arial, sans-serif' font-size='20' fill='#fff'>${text}</text></svg>`;
                return 'data:image/svg+xml;utf8,' + encodeURIComponent(svg);
            }

            function renderMenu(filter = 'All') {
                menuGrid.innerHTML = '';
                const items = filter === 'All' ? menuData : menuData.filter(m => m.category === filter);
                items.forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'menu-card';
                    card.innerHTML = `
                        <img src="${item.img || generatePlaceholder(item.name)}" alt="${item.name}" loading="lazy">
                        <div class="menu-info">
                            <div class="menu-cat">${item.category}</div>
                            <div class="menu-title">${item.name}</div>
                            <div class="menu-desc">${item.desc}</div>
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px;">
                                <div class="menu-price">NPR ${item.price}</div>
                                <button class="add-btn" data-id="${item.id}">Add</button>
                            </div>
                        </div>
                    `;
                    menuGrid.appendChild(card);

                    const imgEl = card.querySelector('img');
                    imgEl.onerror = function() {
                        this.onerror = null;
                        this.src = generatePlaceholder(item.name);
                    };
                });
            }

            categoryBtns.forEach(btn => btn.addEventListener('click', () => {
                categoryBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                renderMenu(btn.dataset.cat);
            }));

            renderMenu(); // initial render

            /* ---------- Cart Logic ---------- */
            let cart = JSON.parse(localStorage.getItem('thakali_cart') || '[]');

            const cartBtn = document.getElementById('cart-btn');
            const cartCountEl = document.getElementById('cart-count');
            const cartPanel = document.getElementById('cart-panel');
            const cartItemsEl = document.getElementById('cart-items');
            const cartTotalEl = document.getElementById('cart-total');
            const checkoutBtn = document.getElementById('checkout-btn');
            const clearCartBtn = document.getElementById('clear-cart-btn');
            const closeCartBtn = document.getElementById('close-cart');

            function updateCartCount() {
                cartCountEl.textContent = cart.reduce((s, it) => s + it.qty, 0);
            }

            function saveCart() {
                localStorage.setItem('thakali_cart', JSON.stringify(cart));
                updateCartCount();
            }

            function renderCart() {
                cartItemsEl.innerHTML = '';
                if (cart.length === 0) {
                    cartItemsEl.innerHTML = '<p>Your cart is empty.</p>';
                    cartTotalEl.textContent = '0.00';
                    return;
                }
                let total = 0;
                cart.forEach(ci => {
                    const item = menuData.find(m => m.id === ci.id);
                    const div = document.createElement('div');
                    div.className = 'cart-item';
                    div.innerHTML = `<div>${item.name} x ${ci.qty}</div><div>NPR ${item.price * ci.qty} <button class="remove-item" data-id="${ci.id}">Remove</button></div>`;
                    cartItemsEl.appendChild(div);
                    total += item.price * ci.qty;
                });
                cartTotalEl.textContent = total.toFixed(2);
            }

            function addToCart(id) {
                const existing = cart.find(c => c.id === id);
                if (existing) existing.qty += 1; else cart.push({ id, qty: 1 });
                saveCart();
                renderCart();
                showTemporaryMessage('Added to cart');
            }

            function removeFromCart(id) {
                cart = cart.filter(c => c.id !== id);
                saveCart();
                renderCart();
            }

            function clearCart() {
                cart = [];
                saveCart();
                renderCart();
            }

            document.body.addEventListener('click', (e) => {
                if (e.target.matches('.add-btn')) {
                    addToCart(e.target.dataset.id);
                }
                if (e.target.matches('.remove-item')) {
                    removeFromCart(e.target.dataset.id);
                }
            });

            cartBtn.addEventListener('click', () => toggleCart(true));
            closeCartBtn.addEventListener('click', () => toggleCart(false));
            clearCartBtn.addEventListener('click', () => clearCart());

            function toggleCart(open) {
                cartPanel.setAttribute('aria-hidden', open ? 'false' : 'true');
                if (open) renderCart();
            }

            checkoutBtn.addEventListener('click', () => {
                if (cart.length === 0) { showTemporaryMessage('Cart is empty'); return; }
                // Simulate order: save to localStorage as orders
                const orders = JSON.parse(localStorage.getItem('thakali_orders') || '[]');
                const newOrder = { id: 'ord_' + Date.now(), items: cart, total: cart.reduce((s, it) => {
                    const m = menuData.find(mm => mm.id === it.id);
                    return s + m.price * it.qty;
                }, 0), created: new Date().toISOString() };
                orders.push(newOrder);
                localStorage.setItem('thakali_orders', JSON.stringify(orders));
                clearCart();
                toggleCart(false);
                // Show modal confirmation with order details
                showOrderModal(newOrder);
            });

            // Order modal helpers
            function showOrderModal(order) {
                const modal = document.getElementById('order-modal');
                const details = document.getElementById('order-details');
                const totalEl = document.getElementById('order-total');
                details.innerHTML = '';
                const list = document.createElement('div');
                order.items.forEach(it => {
                    const m = menuData.find(mm => mm.id === it.id) || { name: it.id, price: 0 };
                    const div = document.createElement('div');
                    div.className = 'order-item';
                    div.textContent = `${m.name} x ${it.qty}`;
                    const priceSpan = document.createElement('span');
                    priceSpan.textContent = `NPR ${m.price * it.qty}`;
                    div.appendChild(priceSpan);
                    details.appendChild(div);
                });
                totalEl.textContent = `Total: NPR ${order.total.toFixed(2)}`;
                document.getElementById('order-msg').textContent = `Order ID: ${order.id}`;
                modal.classList.add('show');
                modal.setAttribute('aria-hidden', 'false');
            }

            function closeOrderModal() {
                const modal = document.getElementById('order-modal');
                modal.classList.remove('show');
                modal.setAttribute('aria-hidden', 'true');
            }

            document.addEventListener('click', (e) => {
                if (e.target && (e.target.id === 'close-order' || e.target.classList.contains('order-modal-close'))) {
                    closeOrderModal();
                }
                if (e.target && e.target.id === 'print-order') {
                    const modalContent = document.querySelector('.order-modal-content');
                    const w = window.open('', '_blank');
                    w.document.write('<html><head><title>Order '+ (document.getElementById('order-msg').textContent) +'</title></head><body>' + modalContent.innerHTML + '</body></html>');
                    w.document.close();
                    w.print();
                }
            });

            // Initialize
            updateCartCount();
            renderCart();

            /* ---------- Contact Form Handling ---------- */
            const contactForm = document.getElementById('contact-form');
            const messagesList = document.getElementById('messages-list');

            function renderMessages() {
                const msgs = JSON.parse(localStorage.getItem('thakali_messages') || '[]');
                messagesList.innerHTML = '';
                if (msgs.length === 0) {
                    messagesList.innerHTML = '<p>No recent requests yet.</p>';
                    return;
                }
                msgs.slice().reverse().forEach(m => {
                    const div = document.createElement('div');
                    div.className = 'review';
                    div.innerHTML = `<img src='https://via.placeholder.com/50' alt='${m.name}'><div><strong>${escapeHtml(m.name)}:</strong> ${escapeHtml(m.message)} <br><small>${new Date(m.created).toLocaleString()}</small></div>`;
                    messagesList.appendChild(div);
                });
            }

            function escapeHtml(text) {
                return String(text).replace(/[&<>"']/g, s => ({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;' })[s]);
            }

            contactForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const name = document.getElementById('c-name').value.trim();
                const email = document.getElementById('c-email').value.trim();
                const phone = document.getElementById('c-phone').value.trim();
                const date = document.getElementById('c-date').value;
                const time = document.getElementById('c-time').value;
                const message = document.getElementById('c-message').value.trim();

                if (!name || !email || !message) { showTemporaryMessage('Please fill name, email and message.'); return; }

                const msgs = JSON.parse(localStorage.getItem('thakali_messages') || '[]');
                msgs.push({ id: 'm_'+Date.now(), name, email, phone, date, time, message, created: new Date().toISOString() });
                localStorage.setItem('thakali_messages', JSON.stringify(msgs));

                contactForm.reset();
                renderMessages();
                showTemporaryMessage('Thank you! Your message/reservation has been recorded (simulated).');
            });

            // Render existing messages
            renderMessages();

            /* ---------- Utilities ---------- */
            function showTemporaryMessage(text) {
                let el = document.createElement('div');
                el.className = 'success';
                el.textContent = text;
                document.body.appendChild(el);
                setTimeout(() => el.remove(), 3000);
            }

        });
    </script>
</body>
</html>